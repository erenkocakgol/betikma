{% extends "socialaccount/base_manage.html" %}
{% load i18n %}
{% load allauth %}
{% block head_title %}
    {% trans "Account Connections" %}
{% endblock head_title %}
{% block content %}
    <div class="container mx-auto px-4 py-8">
        <div class="bg-white rounded-lg shadow-xl p-6 md:p-8 glass-effect border border-gray-200 fade-in-up">
            {% element h1 %}
                <h1 class="text-3xl font-extrabold text-dark-purple mb-6 text-center">
                    <i class="fas fa-link mr-3 text-accent-purple"></i>{% trans "Hesap Bağlantıları" %}
                </h1>
            {% endelement %}

            {% if form.accounts %}
                {% element p %}
                    <p class="text-gray-700 mb-6 text-center md:text-left">
                        {% blocktrans %}Hesabınıza aşağıdaki üçüncü taraf hesaplarından herhangi birini kullanarak giriş yapabilirsiniz:{% endblocktrans %}
                    </p>
                {% endelement %}
                {% url 'socialaccount_connections' as action_url %}
                {% element form form=form method="post" action=action_url %}
                    {% slot body %}
                        {% csrf_token %}
                        <div class="space-y-4 mb-6">
                            {% for acc in form.fields.account.choices %}
                                {% with account=acc.0.instance.get_provider_account %}
                                    {% setvar radio_id %}
                                        id_account_{{ account.account.pk }}
                                    {% endsetvar %}
                                    {% setvar tags %}
                                        socialaccount,{{ account.account.provider }}
                                    {% endsetvar %}
                                    <label for="{{ radio_id }}" class="flex items-center p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors duration-200 shadow-sm">
                                        <input type="radio" name="account" value="{{ account.account.pk }}" id="{{ radio_id }}"
                                               class="form-radio h-5 w-5 text-dark-purple focus:ring-dark-purple mr-3">
                                        <span class="text-lg text-gray-800 font-medium flex-grow">{{ account }}</span>
                                        <div class="ml-4">
                                            {% element badge tags=tags %}
                                                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-pastel-purple text-dark-purple">
                                                    {{ account.get_brand.name }}
                                                </span>
                                            {% endelement %}
                                        </div>
                                    </label>
                                {% endwith %}
                            {% endfor %}
                        </div>
                    {% endslot %}
                    {% slot actions %}
                        <div class="text-center md:text-left">
                            {% element button tags="delete,danger" type="submit" %}
                                <button type="submit" class="modern-button bg-red-500 text-white font-semibold py-2.5 px-6 rounded-lg shadow-md hover:bg-red-600 transition-all duration-300 inline-flex items-center justify-center">
                                    <i class="fas fa-unlink mr-2"></i>{% trans 'Kaldır' %}
                                </button>
                            {% endelement %}
                        </div>
                    {% endslot %}
                {% endelement %}
            {% else %}
                {% element p %}
                    <p class="text-gray-700 mb-6 text-center md:text-left p-3 bg-blue-50 rounded-lg border border-blue-200 flex items-center justify-center md:justify-start">
                        <i class="fas fa-info-circle mr-2 text-blue-500"></i>{% trans 'Şu anda bu hesaba bağlı üçüncü taraf hesabınız bulunmamaktadır.' %}
                    </p>
                {% endelement %}
            {% endif %}

            <hr class="my-8 border-t-2 border-gray-200">

            {% include "socialaccount/snippets/provider_list.html" with process="connect" %}
            {% include "socialaccount/snippets/login_extra.html" %}
        </div>
    </div>
{% endblock content %}